Here is some old version of the code.
